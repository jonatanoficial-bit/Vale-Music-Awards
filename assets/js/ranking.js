(async function(){const mount=document.getElementById("rank");if(!mount)return;const cands=await vpLoadCandidates();const scored=cands.map(c=>{const a=vpAggregate(c.id);return {c,score:a?a.weighted:0};}).sort((a,b)=>b.score-a.score);
mount.innerHTML=scored.slice(0,3).map((x,i)=>`<div class="card" style="padding:16px;margin-top:12px"><b>TOP ${i+1}</b><div style="margin-top:8px;font-size:18px;font-weight:900">${x.c.nomeArtistico||x.c.nome}</div><div style="color:var(--muted)">${x.c.genero||"—"} • ${x.c.cidade||""}</div><div style="margin-top:10px;font-size:26px;font-weight:950;background:linear-gradient(90deg,var(--gold1),var(--gold2));-webkit-background-clip:text;color:transparent">${(x.score||0).toFixed(2)}</div></div>`).join("") +
`<div class="card" style="padding:16px;margin-top:12px"><b>Lista completa</b>${scored.map((x,i)=>`<div style="display:flex;gap:12px;align-items:center;padding:10px 0;border-top:1px solid rgba(255,255,255,.08)"><div style="width:46px"><span style="opacity:.8">#${i+1}</span></div><img src="${x.c.foto||'../assets/img/vale-producao-logo.png'}" style="width:44px;height:44px;border-radius:16px;object-fit:cover;border:1px solid rgba(255,255,255,.10)"/><div style="flex:1"><div style="font-weight:900">${x.c.nomeArtistico||x.c.nome}</div><div style="font-size:12px;color:var(--muted2)">${x.c.id} • ${x.c.genero||"—"}</div></div><div style="font-weight:950">${(x.score||0).toFixed(2)}</div></div>`).join("")}</div>`;
})();